============================================================================================== 
Warning! Mixing Conda and module environments may lead to corruption of the
user environment. 
We do not recommend users mixing those two environments unless absolutely
necessary. Note that 
SURF does not provide any support for Conda environment.
For more information, please refer to our software policy page:
https://servicedesk.surf.nl/wiki/display/WIKI/Software+policy+Snellius#SoftwarepolicySnellius-UseofAnacondaandMinicondaenvironmentsonSnellius 

Remember that many packages have already been installed on the system and can
be loaded using 
the 'module load <package__name>' command. If you are uncertain if a package is
already available 
on the system, please use 'module avail' or 'module spider' to search for it.
============================================================================================== 

EnvironmentNameNotFound: Could not find conda environment: power_of_noise
You can list all discoverable environments with `conda info --envs`.


Note: huggingface-cli login failed, but HF_TOKEN is set
==========================================
Starting experiments for Table 2: Random Documents
==========================================
==========================================
Starting experiments for Table 1: Relevant/Distracting Documents
==========================================
==========================================
Running experiment: near scenario with relevant documents
Gold position: 8
Use random: False
==========================================
`torch_dtype` is deprecated! Use `dtype` instead!
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:14<00:14, 14.96s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:20<00:00,  9.16s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:20<00:00, 10.03s/it]
LLM loaded
Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 8
NUM DOCUMENTS IN CONTEXT: 9
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 20
SAVE EVERY: 250
  0%|          | 0/500 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
  0%|          | 1/500 [00:05<43:39,  5.25s/it]  0%|          | 2/500 [00:09<39:08,  4.72s/it]  1%|          | 3/500 [00:13<36:57,  4.46s/it]  1%|          | 4/500 [00:18<37:30,  4.54s/it]  1%|          | 5/500 [00:22<36:30,  4.43s/it]  1%|          | 6/500 [00:26<35:13,  4.28s/it]  1%|▏         | 7/500 [00:31<35:58,  4.38s/it]  2%|▏         | 8/500 [00:35<35:50,  4.37s/it]  2%|▏         | 9/500 [00:40<36:05,  4.41s/it]  2%|▏         | 10/500 [00:44<35:23,  4.33s/it]  2%|▏         | 11/500 [00:48<36:18,  4.45s/it]  2%|▏         | 12/500 [00:53<36:16,  4.46s/it]  3%|▎         | 13/500 [00:58<36:35,  4.51s/it]  3%|▎         | 14/500 [01:02<36:23,  4.49s/it]  3%|▎         | 15/500 [01:06<36:02,  4.46s/it]  3%|▎         | 16/500 [01:11<35:58,  4.46s/it]  3%|▎         | 17/500 [01:15<36:11,  4.50s/it]  4%|▎         | 18/500 [01:20<36:05,  4.49s/it]  4%|▍         | 19/500 [01:24<35:55,  4.48s/it]  4%|▍         | 20/500 [01:29<35:16,  4.41s/it]  4%|▍         | 21/500 [01:33<35:26,  4.44s/it]  4%|▍         | 22/500 [01:38<35:29,  4.46s/it]  5%|▍         | 23/500 [01:42<35:57,  4.52s/it]  5%|▍         | 24/500 [01:47<35:43,  4.50s/it]  5%|▌         | 25/500 [01:51<35:13,  4.45s/it]  5%|▌         | 26/500 [01:56<35:10,  4.45s/it]  5%|▌         | 27/500 [02:00<35:07,  4.46s/it]  6%|▌         | 28/500 [02:04<34:48,  4.43s/it]  6%|▌         | 29/500 [02:09<34:48,  4.43s/it]  6%|▌         | 30/500 [02:13<35:17,  4.50s/it]  6%|▌         | 31/500 [02:18<34:10,  4.37s/it]  6%|▋         | 32/500 [02:22<34:16,  4.39s/it]  7%|▋         | 33/500 [02:26<34:03,  4.38s/it]  7%|▋         | 34/500 [02:31<34:20,  4.42s/it]  7%|▋         | 35/500 [02:35<34:45,  4.48s/it]  7%|▋         | 36/500 [02:40<34:59,  4.53s/it]  7%|▋         | 37/500 [02:45<35:12,  4.56s/it]  8%|▊         | 38/500 [02:49<34:23,  4.47s/it]  8%|▊         | 39/500 [02:54<34:56,  4.55s/it]  8%|▊         | 40/500 [02:58<35:17,  4.60s/it]  8%|▊         | 41/500 [03:03<35:17,  4.61s/it]  8%|▊         | 42/500 [03:07<33:59,  4.45s/it]  9%|▊         | 43/500 [03:12<34:00,  4.47s/it]  9%|▉         | 44/500 [03:16<33:15,  4.38s/it]  9%|▉         | 45/500 [03:20<33:06,  4.37s/it]  9%|▉         | 46/500 [03:25<33:59,  4.49s/it]  9%|▉         | 47/500 [03:30<34:54,  4.62s/it] 10%|▉         | 48/500 [03:34<34:08,  4.53s/it] 10%|▉         | 49/500 [03:39<34:21,  4.57s/it] 10%|█         | 50/500 [03:43<34:05,  4.54s/it] 10%|█         | 51/500 [03:48<33:38,  4.50s/it] 10%|█         | 52/500 [03:52<33:51,  4.53s/it] 11%|█         | 53/500 [03:57<33:44,  4.53s/it] 11%|█         | 54/500 [04:01<33:40,  4.53s/it] 11%|█         | 55/500 [04:06<32:56,  4.44s/it] 11%|█         | 56/500 [04:10<33:38,  4.55s/it] 11%|█▏        | 57/500 [04:15<33:12,  4.50s/it] 12%|█▏        | 58/500 [04:19<33:03,  4.49s/it] 12%|█▏        | 59/500 [04:24<33:19,  4.53s/it] 12%|█▏        | 60/500 [04:28<33:13,  4.53s/it] 12%|█▏        | 61/500 [04:33<32:19,  4.42s/it] 12%|█▏        | 62/500 [04:37<32:54,  4.51s/it] 13%|█▎        | 63/500 [04:42<32:28,  4.46s/it] 13%|█▎        | 64/500 [04:46<32:13,  4.44s/it] 13%|█▎        | 65/500 [04:50<32:03,  4.42s/it] 13%|█▎        | 66/500 [04:55<32:32,  4.50s/it] 13%|█▎        | 67/500 [05:00<33:35,  4.65s/it] 14%|█▎        | 68/500 [05:05<33:46,  4.69s/it] 14%|█▍        | 69/500 [05:09<33:16,  4.63s/it] 14%|█▍        | 70/500 [05:14<32:40,  4.56s/it] 14%|█▍        | 71/500 [05:18<32:13,  4.51s/it] 14%|█▍        | 72/500 [05:23<31:48,  4.46s/it] 15%|█▍        | 73/500 [05:27<31:50,  4.47s/it] 15%|█▍        | 74/500 [05:31<31:31,  4.44s/it] 15%|█▌        | 75/500 [05:36<31:11,  4.40s/it] 15%|█▌        | 76/500 [05:40<30:38,  4.34s/it] 15%|█▌        | 77/500 [05:44<31:04,  4.41s/it] 16%|█▌        | 78/500 [05:49<32:15,  4.59s/it] 16%|█▌        | 79/500 [05:54<31:25,  4.48s/it] 16%|█▌        | 80/500 [05:58<31:27,  4.49s/it] 16%|█▌        | 81/500 [06:03<31:23,  4.50s/it] 16%|█▋        | 82/500 [06:07<31:10,  4.48s/it] 17%|█▋        | 83/500 [06:12<31:20,  4.51s/it] 17%|█▋        | 84/500 [06:16<30:55,  4.46s/it] 17%|█▋        | 85/500 [06:20<30:03,  4.35s/it] 17%|█▋        | 86/500 [06:25<30:10,  4.37s/it] 17%|█▋        | 87/500 [06:29<31:09,  4.53s/it] 18%|█▊        | 88/500 [06:34<30:48,  4.49s/it] 18%|█▊        | 89/500 [06:38<30:04,  4.39s/it] 18%|█▊        | 90/500 [06:43<30:23,  4.45s/it] 18%|█▊        | 91/500 [06:47<30:24,  4.46s/it] 18%|█▊        | 92/500 [06:51<30:00,  4.41s/it] 19%|█▊        | 93/500 [06:56<29:58,  4.42s/it] 19%|█▉        | 94/500 [07:00<29:46,  4.40s/it] 19%|█▉        | 95/500 [07:04<29:15,  4.33s/it] 19%|█▉        | 96/500 [07:09<29:09,  4.33s/it] 19%|█▉        | 97/500 [07:13<29:35,  4.40s/it] 20%|█▉        | 98/500 [07:18<29:50,  4.45s/it] 20%|█▉        | 99/500 [07:23<30:28,  4.56s/it] 20%|██        | 100/500 [07:27<30:39,  4.60s/it] 20%|██        | 101/500 [07:32<30:04,  4.52s/it] 20%|██        | 102/500 [07:36<29:25,  4.43s/it] 21%|██        | 103/500 [07:41<29:38,  4.48s/it] 21%|██        | 104/500 [07:45<29:03,  4.40s/it] 21%|██        | 105/500 [07:49<28:55,  4.39s/it] 21%|██        | 106/500 [07:54<29:22,  4.47s/it] 21%|██▏       | 107/500 [07:58<29:48,  4.55s/it] 22%|██▏       | 108/500 [08:03<29:19,  4.49s/it] 22%|██▏       | 109/500 [08:07<28:58,  4.45s/it] 22%|██▏       | 110/500 [08:12<28:43,  4.42s/it] 22%|██▏       | 111/500 [08:16<28:57,  4.47s/it] 22%|██▏       | 112/500 [08:21<28:52,  4.47s/it] 23%|██▎       | 113/500 [08:25<29:11,  4.53s/it] 23%|██▎       | 114/500 [08:30<29:04,  4.52s/it] 23%|██▎       | 115/500 [08:34<29:07,  4.54s/it] 23%|██▎       | 116/500 [08:39<29:46,  4.65s/it] 23%|██▎       | 117/500 [08:44<29:47,  4.67s/it] 24%|██▎       | 118/500 [08:49<29:37,  4.65s/it] 24%|██▍       | 119/500 [08:53<29:27,  4.64s/it] 24%|██▍       | 120/500 [08:57<28:37,  4.52s/it] 24%|██▍       | 121/500 [09:02<28:23,  4.49s/it] 24%|██▍       | 122/500 [09:06<28:03,  4.45s/it] 25%|██▍       | 123/500 [09:11<27:57,  4.45s/it] 25%|██▍       | 124/500 [09:15<27:44,  4.43s/it] 25%|██▌       | 125/500 [09:19<27:35,  4.42s/it] 25%|██▌       | 126/500 [09:24<27:49,  4.46s/it] 25%|██▌       | 127/500 [09:28<27:44,  4.46s/it] 26%|██▌       | 128/500 [09:34<28:53,  4.66s/it] 26%|██▌       | 129/500 [09:38<28:45,  4.65s/it] 26%|██▌       | 130/500 [09:43<28:08,  4.56s/it] 26%|██▌       | 131/500 [09:48<28:54,  4.70s/it] 26%|██▋       | 132/500 [09:52<28:08,  4.59s/it] 27%|██▋       | 133/500 [09:57<28:03,  4.59s/it] 27%|██▋       | 134/500 [10:01<28:30,  4.67s/it] 27%|██▋       | 135/500 [10:06<27:50,  4.58s/it] 27%|██▋       | 136/500 [10:10<27:22,  4.51s/it] 27%|██▋       | 137/500 [10:15<27:34,  4.56s/it] 28%|██▊       | 138/500 [10:19<26:55,  4.46s/it] 28%|██▊       | 139/500 [10:23<26:08,  4.35s/it] 28%|██▊       | 140/500 [10:28<26:34,  4.43s/it] 28%|██▊       | 141/500 [10:32<26:25,  4.42s/it] 28%|██▊       | 142/500 [10:37<27:00,  4.53s/it] 29%|██▊       | 143/500 [10:41<26:30,  4.46s/it] 29%|██▉       | 144/500 [10:46<27:15,  4.59s/it] 29%|██▉       | 145/500 [10:51<27:59,  4.73s/it] 29%|██▉       | 146/500 [10:56<27:26,  4.65s/it] 29%|██▉       | 147/500 [11:00<27:03,  4.60s/it] 30%|██▉       | 148/500 [11:04<26:35,  4.53s/it] 30%|██▉       | 149/500 [11:09<26:08,  4.47s/it] 30%|███       | 150/500 [11:14<26:51,  4.60s/it] 30%|███       | 151/500 [11:18<26:52,  4.62s/it] 30%|███       | 152/500 [11:23<26:02,  4.49s/it] 31%|███       | 153/500 [11:27<26:27,  4.57s/it] 31%|███       | 154/500 [11:32<25:48,  4.48s/it] 31%|███       | 155/500 [11:36<25:42,  4.47s/it] 31%|███       | 156/500 [11:40<25:07,  4.38s/it] 31%|███▏      | 157/500 [11:45<25:39,  4.49s/it] 32%|███▏      | 158/500 [11:50<26:16,  4.61s/it] 32%|███▏      | 159/500 [11:54<25:58,  4.57s/it] 32%|███▏      | 160/500 [11:58<25:13,  4.45s/it] 32%|███▏      | 161/500 [12:03<25:08,  4.45s/it] 32%|███▏      | 162/500 [12:07<25:17,  4.49s/it] 33%|███▎      | 163/500 [12:12<25:23,  4.52s/it] 33%|███▎      | 164/500 [12:17<25:29,  4.55s/it] 33%|███▎      | 165/500 [12:21<25:23,  4.55s/it] 33%|███▎      | 166/500 [12:26<25:08,  4.52s/it] 33%|███▎      | 167/500 [12:30<24:31,  4.42s/it] 34%|███▎      | 168/500 [12:34<24:27,  4.42s/it] 34%|███▍      | 169/500 [12:39<25:00,  4.53s/it] 34%|███▍      | 170/500 [12:43<24:09,  4.39s/it] 34%|███▍      | 171/500 [12:48<24:05,  4.39s/it] 34%|███▍      | 172/500 [12:52<24:33,  4.49s/it] 35%|███▍      | 173/500 [12:56<23:59,  4.40s/it] 35%|███▍      | 174/500 [13:01<24:00,  4.42s/it] 35%|███▌      | 175/500 [13:05<23:51,  4.40s/it] 35%|███▌      | 176/500 [13:09<23:25,  4.34s/it] 35%|███▌      | 177/500 [13:14<24:17,  4.51s/it] 36%|███▌      | 178/500 [13:19<24:48,  4.62s/it] 36%|███▌      | 179/500 [13:24<24:17,  4.54s/it] 36%|███▌      | 180/500 [13:28<24:36,  4.61s/it] 36%|███▌      | 181/500 [13:33<24:40,  4.64s/it] 36%|███▋      | 182/500 [13:38<24:10,  4.56s/it] 37%|███▋      | 183/500 [13:42<23:20,  4.42s/it] 37%|███▋      | 184/500 [13:46<23:17,  4.42s/it] 37%|███▋      | 185/500 [13:51<23:41,  4.51s/it] 37%|███▋      | 186/500 [13:55<23:26,  4.48s/it] 37%|███▋      | 187/500 [13:59<22:52,  4.39s/it] 38%|███▊      | 188/500 [14:04<22:45,  4.38s/it] 38%|███▊      | 189/500 [14:08<22:42,  4.38s/it] 38%|███▊      | 190/500 [14:12<22:24,  4.34s/it] 38%|███▊      | 191/500 [14:17<22:36,  4.39s/it] 38%|███▊      | 192/500 [14:21<22:39,  4.42s/it] 39%|███▊      | 193/500 [14:26<22:31,  4.40s/it] 39%|███▉      | 194/500 [14:30<22:57,  4.50s/it] 39%|███▉      | 195/500 [14:35<23:16,  4.58s/it] 39%|███▉      | 196/500 [14:39<22:46,  4.50s/it] 39%|███▉      | 197/500 [14:44<22:23,  4.43s/it] 40%|███▉      | 198/500 [14:48<22:11,  4.41s/it] 40%|███▉      | 199/500 [14:52<22:00,  4.39s/it] 40%|████      | 200/500 [14:57<22:47,  4.56s/it] 40%|████      | 201/500 [15:02<22:19,  4.48s/it] 40%|████      | 202/500 [15:06<22:17,  4.49s/it] 41%|████      | 203/500 [15:10<21:45,  4.40s/it] 41%|████      | 204/500 [15:15<21:47,  4.42s/it] 41%|████      | 205/500 [15:19<21:52,  4.45s/it] 41%|████      | 206/500 [15:24<21:53,  4.47s/it] 41%|████▏     | 207/500 [15:28<21:49,  4.47s/it] 42%|████▏     | 208/500 [15:33<22:05,  4.54s/it] 42%|████▏     | 209/500 [15:38<22:17,  4.59s/it] 42%|████▏     | 210/500 [15:42<22:01,  4.56s/it] 42%|████▏     | 211/500 [15:46<21:16,  4.42s/it] 42%|████▏     | 212/500 [15:51<21:06,  4.40s/it] 43%|████▎     | 213/500 [15:55<21:01,  4.40s/it] 43%|████▎     | 214/500 [16:00<21:24,  4.49s/it] 43%|████▎     | 215/500 [16:04<20:51,  4.39s/it] 43%|████▎     | 216/500 [16:09<21:10,  4.47s/it] 43%|████▎     | 217/500 [16:13<20:44,  4.40s/it] 44%|████▎     | 218/500 [16:17<20:38,  4.39s/it] 44%|████▍     | 219/500 [16:22<21:02,  4.49s/it] 44%|████▍     | 220/500 [16:26<20:56,  4.49s/it] 44%|████▍     | 221/500 [16:31<20:43,  4.46s/it] 44%|████▍     | 222/500 [16:35<20:24,  4.40s/it] 45%|████▍     | 223/500 [16:40<20:29,  4.44s/it] 45%|████▍     | 224/500 [16:44<20:15,  4.40s/it] 45%|████▌     | 225/500 [16:48<20:08,  4.40s/it] 45%|████▌     | 226/500 [16:53<20:00,  4.38s/it] 45%|████▌     | 227/500 [16:57<20:06,  4.42s/it] 46%|████▌     | 228/500 [17:01<19:52,  4.38s/it] 46%|████▌     | 229/500 [17:06<19:36,  4.34s/it] 46%|████▌     | 230/500 [17:10<19:33,  4.35s/it] 46%|████▌     | 231/500 [17:14<19:25,  4.33s/it] 46%|████▋     | 232/500 [17:19<19:09,  4.29s/it] 47%|████▋     | 233/500 [17:23<19:01,  4.28s/it] 47%|████▋     | 234/500 [17:27<19:17,  4.35s/it] 47%|████▋     | 235/500 [17:32<19:22,  4.39s/it] 47%|████▋     | 236/500 [17:36<19:10,  4.36s/it] 47%|████▋     | 237/500 [17:41<19:35,  4.47s/it] 48%|████▊     | 238/500 [17:45<19:08,  4.38s/it] 48%|████▊     | 239/500 [17:50<19:22,  4.45s/it] 48%|████▊     | 240/500 [17:54<19:33,  4.52s/it] 48%|████▊     | 241/500 [17:59<19:24,  4.49s/it] 48%|████▊     | 242/500 [18:03<19:03,  4.43s/it] 49%|████▊     | 243/500 [18:08<19:21,  4.52s/it] 49%|████▉     | 244/500 [18:13<19:45,  4.63s/it] 49%|████▉     | 245/500 [18:17<19:31,  4.59s/it] 49%|████▉     | 246/500 [18:21<18:59,  4.49s/it] 49%|████▉     | 247/500 [18:26<18:52,  4.48s/it] 50%|████▉     | 248/500 [18:30<19:02,  4.53s/it] 50%|████▉     | 249/500 [18:35<18:53,  4.52s/it] 50%|█████     | 250/500 [18:40<19:06,  4.59s/it] 50%|█████     | 251/500 [18:44<18:47,  4.53s/it] 50%|█████     | 252/500 [18:48<18:27,  4.47s/it] 51%|█████     | 253/500 [18:53<18:34,  4.51s/it] 51%|█████     | 254/500 [18:57<18:09,  4.43s/it] 51%|█████     | 255/500 [19:02<18:26,  4.52s/it] 51%|█████     | 256/500 [19:07<18:54,  4.65s/it] 51%|█████▏    | 257/500 [19:12<18:52,  4.66s/it] 52%|█████▏    | 258/500 [19:16<18:32,  4.60s/it] 52%|█████▏    | 259/500 [19:21<18:26,  4.59s/it] 52%|█████▏    | 260/500 [19:25<18:15,  4.57s/it] 52%|█████▏    | 261/500 [19:30<18:16,  4.59s/it] 52%|█████▏    | 262/500 [19:34<17:42,  4.46s/it] 53%|█████▎    | 263/500 [19:38<17:29,  4.43s/it] 53%|█████▎    | 264/500 [19:43<17:38,  4.49s/it] 53%|█████▎    | 265/500 [19:47<17:27,  4.46s/it] 53%|█████▎    | 266/500 [19:52<17:40,  4.53s/it] 53%|█████▎    | 267/500 [19:57<17:41,  4.56s/it] 54%|█████▎    | 268/500 [20:01<17:11,  4.45s/it] 54%|█████▍    | 269/500 [20:06<17:28,  4.54s/it] 54%|█████▍    | 270/500 [20:10<17:03,  4.45s/it] 54%|█████▍    | 271/500 [20:14<17:00,  4.46s/it] 54%|█████▍    | 272/500 [20:19<17:13,  4.53s/it] 55%|█████▍    | 273/500 [20:23<16:47,  4.44s/it] 55%|█████▍    | 274/500 [20:28<16:43,  4.44s/it] 55%|█████▌    | 275/500 [20:32<16:34,  4.42s/it] 55%|█████▌    | 276/500 [20:36<16:26,  4.41s/it] 55%|█████▌    | 277/500 [20:41<16:39,  4.48s/it] 56%|█████▌    | 278/500 [20:45<15:59,  4.32s/it] 56%|█████▌    | 279/500 [20:50<16:05,  4.37s/it] 56%|█████▌    | 280/500 [20:54<15:57,  4.35s/it] 56%|█████▌    | 281/500 [20:59<16:29,  4.52s/it] 56%|█████▋    | 282/500 [21:03<16:06,  4.43s/it] 57%|█████▋    | 283/500 [21:08<16:07,  4.46s/it] 57%|█████▋    | 284/500 [21:12<15:56,  4.43s/it] 57%|█████▋    | 285/500 [21:17<16:06,  4.50s/it] 57%|█████▋    | 286/500 [21:21<15:59,  4.48s/it] 57%|█████▋    | 287/500 [21:26<16:12,  4.57s/it] 58%|█████▊    | 288/500 [21:30<16:12,  4.59s/it] 58%|█████▊    | 289/500 [21:35<15:42,  4.47s/it] 58%|█████▊    | 290/500 [21:40<16:07,  4.60s/it] 58%|█████▊    | 291/500 [21:44<15:29,  4.45s/it] 58%|█████▊    | 292/500 [21:48<15:28,  4.46s/it] 59%|█████▊    | 293/500 [21:52<15:14,  4.42s/it] 59%|█████▉    | 294/500 [21:57<15:05,  4.40s/it] 59%|█████▉    | 295/500 [22:02<15:42,  4.60s/it] 59%|█████▉    | 296/500 [22:06<15:30,  4.56s/it] 59%|█████▉    | 297/500 [22:11<15:28,  4.58s/it] 60%|█████▉    | 298/500 [22:15<15:25,  4.58s/it] 60%|█████▉    | 299/500 [22:20<15:06,  4.51s/it] 60%|██████    | 300/500 [22:24<15:10,  4.55s/it] 60%|██████    | 301/500 [22:29<15:09,  4.57s/it] 60%|██████    | 302/500 [22:34<14:57,  4.53s/it] 61%|██████    | 303/500 [22:38<14:32,  4.43s/it] 61%|██████    | 304/500 [22:42<14:22,  4.40s/it] 61%|██████    | 305/500 [22:47<14:23,  4.43s/it] 61%|██████    | 306/500 [22:51<14:28,  4.48s/it] 61%|██████▏   | 307/500 [22:55<14:13,  4.42s/it] 62%|██████▏   | 308/500 [23:00<14:25,  4.51s/it] 62%|██████▏   | 309/500 [23:05<14:18,  4.50s/it] 62%|██████▏   | 310/500 [23:09<14:07,  4.46s/it] 62%|██████▏   | 311/500 [23:14<14:13,  4.51s/it] 62%|██████▏   | 312/500 [23:18<14:05,  4.50s/it] 63%|██████▎   | 313/500 [23:23<14:01,  4.50s/it] 63%|██████▎   | 314/500 [23:27<14:06,  4.55s/it] 63%|██████▎   | 315/500 [23:32<13:56,  4.52s/it] 63%|██████▎   | 316/500 [23:36<13:58,  4.56s/it] 63%|██████▎   | 317/500 [23:41<13:42,  4.49s/it] 64%|██████▎   | 318/500 [23:45<13:42,  4.52s/it] 64%|██████▍   | 319/500 [23:50<13:44,  4.55s/it] 64%|██████▍   | 320/500 [23:54<13:26,  4.48s/it] 64%|██████▍   | 321/500 [23:59<13:32,  4.54s/it] 64%|██████▍   | 322/500 [24:03<13:08,  4.43s/it] 65%|██████▍   | 323/500 [24:07<12:57,  4.39s/it] 65%|██████▍   | 324/500 [24:12<12:58,  4.42s/it] 65%|██████▌   | 325/500 [24:16<12:52,  4.42s/it] 65%|██████▌   | 326/500 [24:21<12:52,  4.44s/it] 65%|██████▌   | 327/500 [24:25<12:34,  4.36s/it] 66%|██████▌   | 328/500 [24:29<12:29,  4.35s/it] 66%|██████▌   | 329/500 [24:34<12:18,  4.32s/it] 66%|██████▌   | 330/500 [24:38<12:10,  4.30s/it] 66%|██████▌   | 331/500 [24:42<12:07,  4.31s/it] 66%|██████▋   | 332/500 [24:46<11:59,  4.28s/it] 67%|██████▋   | 333/500 [24:51<12:05,  4.34s/it] 67%|██████▋   | 334/500 [24:55<12:14,  4.42s/it] 67%|██████▋   | 335/500 [25:00<12:06,  4.40s/it] 67%|██████▋   | 336/500 [25:04<11:59,  4.39s/it] 67%|██████▋   | 337/500 [25:09<11:59,  4.41s/it] 68%|██████▊   | 338/500 [25:13<12:09,  4.50s/it] 68%|██████▊   | 339/500 [25:18<11:56,  4.45s/it] 68%|██████▊   | 340/500 [25:22<11:47,  4.42s/it] 68%|██████▊   | 341/500 [25:27<11:54,  4.49s/it] 68%|██████▊   | 342/500 [25:31<11:37,  4.41s/it] 69%|██████▊   | 343/500 [25:36<11:42,  4.48s/it] 69%|██████▉   | 344/500 [25:40<12:00,  4.62s/it] 69%|██████▉   | 345/500 [25:45<11:32,  4.46s/it] 69%|██████▉   | 346/500 [25:50<11:50,  4.61s/it] 69%|██████▉   | 347/500 [25:54<11:38,  4.57s/it] 70%|██████▉   | 348/500 [25:58<11:18,  4.46s/it] 70%|██████▉   | 349/500 [26:03<11:16,  4.48s/it] 70%|███████   | 350/500 [26:07<11:03,  4.42s/it] 70%|███████   | 351/500 [26:11<10:48,  4.35s/it] 70%|███████   | 352/500 [26:16<11:06,  4.51s/it] 71%|███████   | 353/500 [26:21<10:58,  4.48s/it] 71%|███████   | 354/500 [26:25<10:46,  4.43s/it] 71%|███████   | 355/500 [26:30<10:54,  4.52s/it] 71%|███████   | 356/500 [26:34<10:38,  4.43s/it] 71%|███████▏  | 357/500 [26:38<10:35,  4.44s/it] 72%|███████▏  | 358/500 [26:43<10:43,  4.53s/it] 72%|███████▏  | 359/500 [26:47<10:35,  4.50s/it] 72%|███████▏  | 360/500 [26:52<10:37,  4.55s/it] 72%|███████▏  | 361/500 [26:56<10:11,  4.40s/it] 72%|███████▏  | 362/500 [27:00<09:58,  4.34s/it] 73%|███████▎  | 363/500 [27:05<09:50,  4.31s/it] 73%|███████▎  | 364/500 [27:09<09:43,  4.29s/it] 73%|███████▎  | 365/500 [27:13<09:42,  4.31s/it] 73%|███████▎  | 366/500 [27:18<09:50,  4.41s/it] 73%|███████▎  | 367/500 [27:22<09:47,  4.42s/it] 74%|███████▎  | 368/500 [27:26<09:30,  4.32s/it] 74%|███████▍  | 369/500 [27:31<09:31,  4.36s/it] 74%|███████▍  | 370/500 [27:35<09:32,  4.40s/it] 74%|███████▍  | 371/500 [27:40<09:20,  4.35s/it] 74%|███████▍  | 372/500 [27:44<09:16,  4.35s/it] 75%|███████▍  | 373/500 [27:48<09:11,  4.35s/it] 75%|███████▍  | 374/500 [27:53<09:22,  4.46s/it] 75%|███████▌  | 375/500 [27:57<09:09,  4.40s/it] 75%|███████▌  | 376/500 [28:02<09:03,  4.39s/it] 75%|███████▌  | 377/500 [28:06<08:57,  4.37s/it] 76%|███████▌  | 378/500 [28:10<09:01,  4.44s/it] 76%|███████▌  | 379/500 [28:15<08:57,  4.44s/it] 76%|███████▌  | 380/500 [28:19<08:54,  4.45s/it] 76%|███████▌  | 381/500 [28:24<08:47,  4.43s/it] 76%|███████▋  | 382/500 [28:29<08:55,  4.54s/it] 77%|███████▋  | 383/500 [28:33<08:47,  4.51s/it] 77%|███████▋  | 384/500 [28:37<08:36,  4.45s/it] 77%|███████▋  | 385/500 [28:42<08:28,  4.42s/it] 77%|███████▋  | 386/500 [28:47<08:42,  4.58s/it] 77%|███████▋  | 387/500 [28:51<08:23,  4.45s/it] 78%|███████▊  | 388/500 [28:55<08:15,  4.42s/it] 78%|███████▊  | 389/500 [29:00<08:12,  4.44s/it] 78%|███████▊  | 390/500 [29:04<08:06,  4.42s/it] 78%|███████▊  | 391/500 [29:08<07:55,  4.36s/it] 78%|███████▊  | 392/500 [29:13<07:55,  4.41s/it] 79%|███████▊  | 393/500 [29:18<08:07,  4.56s/it] 79%|███████▉  | 394/500 [29:22<07:57,  4.50s/it] 79%|███████▉  | 395/500 [29:26<07:40,  4.38s/it] 79%|███████▉  | 396/500 [29:31<07:42,  4.45s/it] 79%|███████▉  | 397/500 [29:35<07:38,  4.45s/it] 80%|███████▉  | 398/500 [29:40<07:40,  4.51s/it] 80%|███████▉  | 399/500 [29:45<07:51,  4.67s/it] 80%|████████  | 400/500 [29:49<07:33,  4.54s/it] 80%|████████  | 401/500 [29:54<07:31,  4.56s/it] 80%|████████  | 402/500 [29:58<07:30,  4.59s/it] 81%|████████  | 403/500 [30:03<07:19,  4.53s/it] 81%|████████  | 404/500 [30:07<07:13,  4.51s/it] 81%|████████  | 405/500 [30:12<07:11,  4.54s/it] 81%|████████  | 406/500 [30:17<07:14,  4.62s/it] 81%|████████▏ | 407/500 [30:21<07:02,  4.54s/it] 81%|████████▏ | 407/500 [30:27<06:57,  4.49s/it]
Saving at 250...
Traceback (most recent call last):
  File "/gpfs/home1/scur2158/The-Power-of-Noise/src/generate_answers_llm.py", line 208, in <module>
    main()
    ~~~~^^
  File "/gpfs/home1/scur2158/The-Power-of-Noise/src/generate_answers_llm.py", line 202, in main
    generate_and_save(args, llm, prompt_dataloader)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home1/scur2158/The-Power-of-Noise/src/generate_answers_llm.py", line 158, in generate_and_save
    generated_output = llm.generate(prompts, max_new_tokens=args.max_new_tokens)
  File "/gpfs/home1/scur2158/The-Power-of-Noise/src/llm.py", line 119, in generate
    generated_ids = self.model.generate(
        **inputs,
    ...<5 lines>...
        eos_token_id=self.tokenizer.eos_token_id,
    )
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/generation/utils.py", line 2564, in generate
    result = decoding_method(
        self,
    ...<5 lines>...
        **model_kwargs,
    )
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/generation/utils.py", line 2784, in _sample
    outputs = self(**model_inputs, return_dict=True)
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/utils/generic.py", line 918, in wrapper
    output = func(self, *args, **kwargs)
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/models/llama/modeling_llama.py", line 459, in forward
    outputs: BaseModelOutputWithPast = self.model(
                                       ~~~~~~~~~~^
        input_ids=input_ids,
        ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/utils/generic.py", line 1064, in wrapper
    outputs = func(self, *args, **kwargs)
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/models/llama/modeling_llama.py", line 395, in forward
    hidden_states = decoder_layer(
        hidden_states,
    ...<5 lines>...
        **kwargs,
    )
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/modeling_layers.py", line 94, in __call__
    return super().__call__(*args, **kwargs)
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/utils/deprecation.py", line 172, in wrapped_func
    return func(*args, **kwargs)
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/models/llama/modeling_llama.py", line 309, in forward
    hidden_states = self.mlp(hidden_states)
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/models/llama/modeling_llama.py", line 155, in forward
    down_proj = self.down_proj(self.act_fn(self.gate_proj(x)) * self.up_proj(x))
                               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 964.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 761.25 MiB is free. Including non-PyTorch memory, this process has 38.74 GiB memory in use. Of the allocated memory 29.40 GiB is allocated by PyTorch, and 8.84 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Completed: near scenario with relevant documents

==========================================
Running experiment: far scenario with relevant documents
Gold position: 0
Use random: False
==========================================
`torch_dtype` is deprecated! Use `dtype` instead!
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:08<00:08,  8.43s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  5.12s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  5.62s/it]
LLM loaded
Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 0
NUM DOCUMENTS IN CONTEXT: 9
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 20
SAVE EVERY: 250
  0%|          | 0/500 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
  0%|          | 1/500 [00:05<42:22,  5.10s/it]  0%|          | 2/500 [00:09<38:36,  4.65s/it]  1%|          | 3/500 [00:13<36:44,  4.44s/it]  1%|          | 4/500 [00:18<37:24,  4.52s/it]  1%|          | 5/500 [00:22<36:28,  4.42s/it]  1%|          | 6/500 [00:26<35:12,  4.28s/it]  1%|▏         | 7/500 [00:31<35:58,  4.38s/it]  2%|▏         | 8/500 [00:35<35:52,  4.37s/it]  2%|▏         | 9/500 [00:39<36:07,  4.42s/it]  2%|▏         | 10/500 [00:44<35:25,  4.34s/it]  2%|▏         | 11/500 [00:48<36:18,  4.46s/it]  2%|▏         | 12/500 [00:53<36:17,  4.46s/it]  3%|▎         | 13/500 [00:57<36:37,  4.51s/it]  3%|▎         | 14/500 [01:02<36:24,  4.50s/it]  3%|▎         | 15/500 [01:06<36:05,  4.47s/it]  3%|▎         | 16/500 [01:11<36:02,  4.47s/it]  3%|▎         | 17/500 [01:15<36:14,  4.50s/it]  4%|▎         | 18/500 [01:20<36:08,  4.50s/it]  4%|▍         | 19/500 [01:24<35:58,  4.49s/it]  4%|▍         | 20/500 [01:29<35:17,  4.41s/it]  4%|▍         | 21/500 [01:33<35:29,  4.44s/it]  4%|▍         | 22/500 [01:38<35:32,  4.46s/it]  5%|▍         | 23/500 [01:42<35:59,  4.53s/it]  5%|▍         | 24/500 [01:47<35:45,  4.51s/it]  5%|▌         | 25/500 [01:51<35:14,  4.45s/it]  5%|▌         | 26/500 [01:56<35:11,  4.45s/it]  5%|▌         | 27/500 [02:00<35:10,  4.46s/it]  6%|▌         | 28/500 [02:04<34:51,  4.43s/it]  6%|▌         | 29/500 [02:09<34:49,  4.44s/it]  6%|▌         | 30/500 [02:13<35:19,  4.51s/it]  6%|▌         | 31/500 [02:18<34:12,  4.38s/it]  6%|▋         | 32/500 [02:22<34:18,  4.40s/it]  7%|▋         | 33/500 [02:26<34:06,  4.38s/it]  7%|▋         | 34/500 [02:31<34:22,  4.43s/it]  7%|▋         | 35/500 [02:35<34:47,  4.49s/it]  7%|▋         | 36/500 [02:40<35:01,  4.53s/it]  7%|▋         | 37/500 [02:45<35:13,  4.56s/it]  8%|▊         | 38/500 [02:49<34:26,  4.47s/it]  8%|▊         | 39/500 [02:54<34:58,  4.55s/it]  8%|▊         | 40/500 [02:59<35:20,  4.61s/it]  8%|▊         | 41/500 [03:03<35:19,  4.62s/it]  8%|▊         | 42/500 [03:07<34:01,  4.46s/it]  9%|▊         | 43/500 [03:12<34:01,  4.47s/it]  9%|▉         | 44/500 [03:16<33:16,  4.38s/it]  9%|▉         | 45/500 [03:20<33:07,  4.37s/it]  9%|▉         | 46/500 [03:25<34:01,  4.50s/it]  9%|▉         | 47/500 [03:30<34:55,  4.63s/it] 10%|▉         | 48/500 [03:34<34:10,  4.54s/it] 10%|▉         | 49/500 [03:39<34:21,  4.57s/it] 10%|█         | 50/500 [03:43<34:08,  4.55s/it] 10%|█         | 51/500 [03:48<33:41,  4.50s/it] 10%|█         | 52/500 [03:52<33:54,  4.54s/it] 11%|█         | 53/500 [03:57<33:46,  4.53s/it] 11%|█         | 54/500 [04:02<33:43,  4.54s/it] 11%|█         | 55/500 [04:06<33:00,  4.45s/it] 11%|█         | 56/500 [04:11<33:42,  4.56s/it] 11%|█▏        | 57/500 [04:15<33:15,  4.51s/it] 12%|█▏        | 58/500 [04:19<33:06,  4.49s/it] 12%|█▏        | 59/500 [04:24<33:22,  4.54s/it] 12%|█▏        | 60/500 [04:29<33:15,  4.53s/it] 12%|█▏        | 61/500 [04:33<32:21,  4.42s/it] 12%|█▏        | 62/500 [04:37<32:55,  4.51s/it] 13%|█▎        | 63/500 [04:42<32:29,  4.46s/it] 13%|█▎        | 64/500 [04:46<32:15,  4.44s/it] 13%|█▎        | 65/500 [04:51<32:05,  4.43s/it] 13%|█▎        | 66/500 [04:55<32:34,  4.50s/it] 13%|█▎        | 67/500 [05:00<33:37,  4.66s/it] 14%|█▎        | 68/500 [05:05<33:49,  4.70s/it] 14%|█▍        | 69/500 [05:10<33:19,  4.64s/it] 14%|█▍        | 70/500 [05:14<32:42,  4.56s/it] 14%|█▍        | 71/500 [05:18<32:15,  4.51s/it] 14%|█▍        | 72/500 [05:23<31:51,  4.47s/it] 15%|█▍        | 73/500 [05:27<31:53,  4.48s/it] 15%|█▍        | 74/500 [05:32<31:33,  4.45s/it] 15%|█▌        | 75/500 [05:36<31:14,  4.41s/it] 15%|█▌        | 76/500 [05:40<30:40,  4.34s/it] 15%|█▌        | 77/500 [05:45<31:06,  4.41s/it] 16%|█▌        | 78/500 [05:50<32:17,  4.59s/it] 16%|█▌        | 79/500 [05:54<31:27,  4.48s/it] 16%|█▌        | 80/500 [05:58<31:28,  4.50s/it] 16%|█▌        | 81/500 [06:03<31:24,  4.50s/it] 16%|█▋        | 82/500 [06:07<31:11,  4.48s/it] 17%|█▋        | 83/500 [06:12<31:21,  4.51s/it] 17%|█▋        | 84/500 [06:16<30:56,  4.46s/it] 17%|█▋        | 85/500 [06:20<30:05,  4.35s/it] 17%|█▋        | 86/500 [06:25<30:12,  4.38s/it] 17%|█▋        | 87/500 [06:30<31:11,  4.53s/it] 18%|█▊        | 88/500 [06:34<30:49,  4.49s/it] 18%|█▊        | 89/500 [06:38<30:06,  4.40s/it] 18%|█▊        | 90/500 [06:43<30:25,  4.45s/it] 18%|█▊        | 91/500 [06:47<30:27,  4.47s/it] 18%|█▊        | 92/500 [06:52<30:02,  4.42s/it] 19%|█▊        | 93/500 [06:56<30:00,  4.42s/it] 19%|█▉        | 94/500 [07:01<29:47,  4.40s/it] 19%|█▉        | 95/500 [07:05<29:17,  4.34s/it] 19%|█▉        | 96/500 [07:09<29:11,  4.34s/it] 19%|█▉        | 97/500 [07:14<29:37,  4.41s/it] 20%|█▉        | 98/500 [07:18<29:52,  4.46s/it] 20%|█▉        | 99/500 [07:23<30:31,  4.57s/it] 20%|██        | 100/500 [07:28<30:42,  4.61s/it] 20%|██        | 101/500 [07:32<30:07,  4.53s/it] 20%|██        | 102/500 [07:36<29:27,  4.44s/it] 21%|██        | 103/500 [07:41<29:40,  4.49s/it] 21%|██        | 104/500 [07:45<29:05,  4.41s/it] 21%|██        | 105/500 [07:49<28:56,  4.40s/it] 21%|██        | 106/500 [07:54<29:24,  4.48s/it] 21%|██▏       | 107/500 [07:59<29:51,  4.56s/it] 22%|██▏       | 108/500 [08:03<29:22,  4.50s/it] 22%|██▏       | 109/500 [08:08<29:01,  4.45s/it] 22%|██▏       | 110/500 [08:12<28:46,  4.43s/it] 22%|██▏       | 111/500 [08:17<29:00,  4.48s/it] 22%|██▏       | 112/500 [08:21<28:55,  4.47s/it] 23%|██▎       | 113/500 [08:26<29:14,  4.53s/it] 23%|██▎       | 114/500 [08:30<29:06,  4.52s/it] 23%|██▎       | 115/500 [08:35<29:08,  4.54s/it] 23%|██▎       | 116/500 [08:40<29:48,  4.66s/it] 23%|██▎       | 117/500 [08:44<29:47,  4.67s/it] 24%|██▎       | 118/500 [08:49<29:39,  4.66s/it] 24%|██▍       | 119/500 [08:54<29:30,  4.65s/it] 24%|██▍       | 120/500 [08:58<28:39,  4.52s/it] 24%|██▍       | 121/500 [09:02<28:25,  4.50s/it] 24%|██▍       | 122/500 [09:07<28:06,  4.46s/it] 25%|██▍       | 123/500 [09:11<27:59,  4.45s/it] 25%|██▍       | 124/500 [09:16<27:46,  4.43s/it] 25%|██▌       | 125/500 [09:20<27:37,  4.42s/it] 25%|██▌       | 126/500 [09:25<27:51,  4.47s/it] 25%|██▌       | 127/500 [09:29<27:46,  4.47s/it] 26%|██▌       | 128/500 [09:34<28:54,  4.66s/it] 26%|██▌       | 129/500 [09:39<28:48,  4.66s/it] 26%|██▌       | 130/500 [09:43<28:11,  4.57s/it] 26%|██▌       | 131/500 [09:48<28:58,  4.71s/it] 26%|██▋       | 132/500 [09:52<28:11,  4.60s/it] 27%|██▋       | 133/500 [09:57<28:07,  4.60s/it] 27%|██▋       | 134/500 [10:02<28:33,  4.68s/it] 27%|██▋       | 135/500 [10:06<27:53,  4.59s/it] 27%|██▋       | 136/500 [10:11<27:25,  4.52s/it] 27%|██▋       | 137/500 [10:15<27:36,  4.56s/it] 28%|██▊       | 138/500 [10:20<26:57,  4.47s/it] 28%|██▊       | 139/500 [10:24<26:09,  4.35s/it] 28%|██▊       | 140/500 [10:28<26:35,  4.43s/it] 28%|██▊       | 141/500 [10:33<26:25,  4.42s/it] 28%|██▊       | 142/500 [10:37<27:01,  4.53s/it] 29%|██▊       | 143/500 [10:42<26:32,  4.46s/it] 29%|██▉       | 144/500 [10:47<27:17,  4.60s/it] 29%|██▉       | 145/500 [10:52<28:00,  4.73s/it] 29%|██▉       | 146/500 [10:56<27:28,  4.66s/it] 29%|██▉       | 147/500 [11:01<27:04,  4.60s/it] 30%|██▉       | 148/500 [11:05<26:36,  4.54s/it] 30%|██▉       | 149/500 [11:09<26:09,  4.47s/it] 30%|███       | 150/500 [11:14<26:52,  4.61s/it] 30%|███       | 151/500 [11:19<26:53,  4.62s/it] 30%|███       | 152/500 [11:23<26:02,  4.49s/it] 31%|███       | 153/500 [11:28<26:29,  4.58s/it] 31%|███       | 154/500 [11:32<25:50,  4.48s/it] 31%|███       | 155/500 [11:37<25:44,  4.48s/it] 31%|███       | 156/500 [11:41<25:09,  4.39s/it] 31%|███▏      | 157/500 [11:46<25:42,  4.50s/it] 32%|███▏      | 158/500 [11:50<26:17,  4.61s/it] 32%|███▏      | 159/500 [11:55<25:59,  4.57s/it] 32%|███▏      | 160/500 [11:59<25:13,  4.45s/it] 32%|███▏      | 161/500 [12:04<25:08,  4.45s/it] 32%|███▏      | 162/500 [12:08<25:17,  4.49s/it] 33%|███▎      | 163/500 [12:13<25:24,  4.52s/it] 33%|███▎      | 164/500 [12:17<25:31,  4.56s/it] 33%|███▎      | 165/500 [12:22<25:24,  4.55s/it] 33%|███▎      | 166/500 [12:26<25:09,  4.52s/it] 33%|███▎      | 167/500 [12:31<24:32,  4.42s/it] 34%|███▎      | 168/500 [12:35<24:29,  4.42s/it] 34%|███▍      | 169/500 [12:40<25:02,  4.54s/it] 34%|███▍      | 170/500 [12:44<24:11,  4.40s/it] 34%|███▍      | 171/500 [12:48<24:06,  4.40s/it] 34%|███▍      | 172/500 [12:53<24:34,  4.49s/it] 35%|███▍      | 173/500 [12:57<24:00,  4.40s/it] 35%|███▍      | 174/500 [13:02<24:01,  4.42s/it] 35%|███▌      | 175/500 [13:06<23:54,  4.41s/it] 35%|███▌      | 176/500 [13:10<23:28,  4.35s/it] 35%|███▌      | 177/500 [13:15<24:19,  4.52s/it] 36%|███▌      | 178/500 [13:20<24:50,  4.63s/it] 36%|███▌      | 179/500 [13:24<24:19,  4.55s/it] 36%|███▌      | 180/500 [13:29<24:38,  4.62s/it] 36%|███▌      | 181/500 [13:34<24:42,  4.65s/it] 36%|███▋      | 182/500 [13:38<24:11,  4.57s/it] 37%|███▋      | 183/500 [13:42<23:21,  4.42s/it] 37%|███▋      | 184/500 [13:47<23:19,  4.43s/it] 37%|███▋      | 185/500 [13:52<23:42,  4.52s/it] 37%|███▋      | 186/500 [13:56<23:26,  4.48s/it] 37%|███▋      | 187/500 [14:00<22:54,  4.39s/it] 38%|███▊      | 188/500 [14:04<22:47,  4.38s/it] 38%|███▊      | 189/500 [14:09<22:43,  4.39s/it] 38%|███▊      | 190/500 [14:13<22:26,  4.34s/it] 38%|███▊      | 191/500 [14:18<22:38,  4.40s/it] 38%|███▊      | 192/500 [14:22<22:41,  4.42s/it] 39%|███▊      | 193/500 [14:26<22:32,  4.41s/it] 39%|███▉      | 194/500 [14:31<22:58,  4.51s/it] 39%|███▉      | 195/500 [14:36<23:17,  4.58s/it] 39%|███▉      | 196/500 [14:40<22:47,  4.50s/it] 39%|███▉      | 197/500 [14:45<22:24,  4.44s/it] 40%|███▉      | 198/500 [14:49<22:12,  4.41s/it] 40%|███▉      | 199/500 [14:53<22:02,  4.39s/it] 40%|████      | 200/500 [14:58<22:48,  4.56s/it] 40%|████      | 201/500 [15:03<22:21,  4.49s/it] 40%|████      | 202/500 [15:07<22:19,  4.50s/it] 41%|████      | 203/500 [15:11<21:46,  4.40s/it] 41%|████      | 204/500 [15:16<21:48,  4.42s/it] 41%|████      | 205/500 [15:20<21:53,  4.45s/it] 41%|████      | 206/500 [15:25<21:53,  4.47s/it] 41%|████▏     | 207/500 [15:29<21:49,  4.47s/it] 42%|████▏     | 208/500 [15:34<22:06,  4.54s/it] 42%|████▏     | 209/500 [15:39<22:17,  4.60s/it] 42%|████▏     | 210/500 [15:43<22:02,  4.56s/it] 42%|████▏     | 211/500 [15:47<21:16,  4.42s/it] 42%|████▏     | 212/500 [15:52<21:07,  4.40s/it] 43%|████▎     | 213/500 [15:56<21:02,  4.40s/it] 43%|████▎     | 214/500 [16:01<21:25,  4.50s/it] 43%|████▎     | 215/500 [16:05<20:53,  4.40s/it] 43%|████▎     | 216/500 [16:09<21:11,  4.48s/it] 43%|████▎     | 217/500 [16:14<20:45,  4.40s/it] 44%|████▎     | 218/500 [16:18<20:39,  4.40s/it] 44%|████▍     | 219/500 [16:23<21:02,  4.49s/it] 44%|████▍     | 220/500 [16:27<20:56,  4.49s/it] 44%|████▍     | 221/500 [16:32<20:43,  4.46s/it] 44%|████▍     | 222/500 [16:36<20:26,  4.41s/it] 45%|████▍     | 223/500 [16:40<20:30,  4.44s/it] 45%|████▍     | 224/500 [16:45<20:16,  4.41s/it] 45%|████▌     | 225/500 [16:49<20:10,  4.40s/it] 45%|████▌     | 226/500 [16:54<20:02,  4.39s/it] 45%|████▌     | 227/500 [16:58<20:08,  4.43s/it] 46%|████▌     | 228/500 [17:02<19:54,  4.39s/it] 46%|████▌     | 229/500 [17:07<19:39,  4.35s/it] 46%|████▌     | 230/500 [17:11<19:35,  4.35s/it] 46%|████▌     | 231/500 [17:15<19:28,  4.34s/it] 46%|████▋     | 232/500 [17:20<19:10,  4.29s/it] 47%|████▋     | 233/500 [17:24<19:02,  4.28s/it] 47%|████▋     | 234/500 [17:28<19:19,  4.36s/it] 47%|████▋     | 235/500 [17:33<19:24,  4.39s/it] 47%|████▋     | 236/500 [17:37<19:11,  4.36s/it] 47%|████▋     | 237/500 [17:42<19:36,  4.47s/it] 48%|████▊     | 238/500 [17:46<19:08,  4.38s/it] 48%|████▊     | 239/500 [17:51<19:23,  4.46s/it] 48%|████▊     | 240/500 [17:55<19:33,  4.51s/it] 48%|████▊     | 241/500 [18:00<19:23,  4.49s/it] 48%|████▊     | 242/500 [18:04<19:03,  4.43s/it] 49%|████▊     | 243/500 [18:09<19:20,  4.52s/it] 49%|████▉     | 244/500 [18:14<19:45,  4.63s/it] 49%|████▉     | 245/500 [18:18<19:31,  4.60s/it] 49%|████▉     | 246/500 [18:22<19:00,  4.49s/it] 49%|████▉     | 247/500 [18:27<18:53,  4.48s/it] 50%|████▉     | 248/500 [18:31<19:03,  4.54s/it] 50%|████▉     | 249/500 [18:36<18:54,  4.52s/it] 50%|█████     | 250/500 [18:41<19:08,  4.59s/it] 50%|█████     | 251/500 [18:45<18:48,  4.53s/it] 50%|█████     | 252/500 [18:49<18:28,  4.47s/it] 51%|█████     | 253/500 [18:54<18:32,  4.50s/it] 51%|█████     | 254/500 [18:58<18:08,  4.43s/it] 51%|█████     | 255/500 [19:03<18:25,  4.51s/it] 51%|█████     | 256/500 [19:08<18:54,  4.65s/it] 51%|█████▏    | 257/500 [19:13<18:52,  4.66s/it] 52%|█████▏    | 258/500 [19:17<18:32,  4.60s/it] 52%|█████▏    | 259/500 [19:22<18:26,  4.59s/it] 52%|█████▏    | 260/500 [19:26<18:16,  4.57s/it] 52%|█████▏    | 261/500 [19:31<18:17,  4.59s/it] 52%|█████▏    | 262/500 [19:35<17:43,  4.47s/it] 53%|█████▎    | 263/500 [19:39<17:30,  4.43s/it] 53%|█████▎    | 264/500 [19:44<17:39,  4.49s/it] 53%|█████▎    | 265/500 [19:48<17:28,  4.46s/it] 53%|█████▎    | 266/500 [19:53<17:43,  4.54s/it] 53%|█████▎    | 267/500 [19:58<17:43,  4.57s/it] 54%|█████▎    | 268/500 [20:02<17:13,  4.45s/it] 54%|█████▍    | 269/500 [20:07<17:29,  4.54s/it] 54%|█████▍    | 270/500 [20:11<17:04,  4.45s/it] 54%|█████▍    | 271/500 [20:15<17:01,  4.46s/it] 54%|█████▍    | 272/500 [20:20<17:13,  4.53s/it] 55%|█████▍    | 273/500 [20:24<16:48,  4.44s/it] 55%|█████▍    | 274/500 [20:29<16:43,  4.44s/it] 55%|█████▌    | 275/500 [20:33<16:34,  4.42s/it] 55%|█████▌    | 276/500 [20:38<16:27,  4.41s/it] 55%|█████▌    | 277/500 [20:42<16:39,  4.48s/it] 56%|█████▌    | 278/500 [20:46<16:00,  4.33s/it] 56%|█████▌    | 279/500 [20:51<16:06,  4.37s/it] 56%|█████▌    | 280/500 [20:55<15:58,  4.36s/it] 56%|█████▌    | 281/500 [21:00<16:30,  4.52s/it] 56%|█████▋    | 282/500 [21:04<16:07,  4.44s/it] 57%|█████▋    | 283/500 [21:09<16:08,  4.47s/it] 57%|█████▋    | 284/500 [21:13<15:57,  4.43s/it] 57%|█████▋    | 285/500 [21:18<16:08,  4.50s/it] 57%|█████▋    | 286/500 [21:22<16:00,  4.49s/it] 57%|█████▋    | 287/500 [21:27<16:14,  4.57s/it] 58%|█████▊    | 288/500 [21:32<16:14,  4.60s/it] 58%|█████▊    | 289/500 [21:36<15:43,  4.47s/it] 58%|█████▊    | 290/500 [21:41<16:08,  4.61s/it] 58%|█████▊    | 291/500 [21:45<15:30,  4.45s/it] 58%|█████▊    | 292/500 [21:49<15:30,  4.47s/it] 59%|█████▊    | 293/500 [21:54<15:15,  4.42s/it] 59%|█████▉    | 294/500 [21:58<15:06,  4.40s/it] 59%|█████▉    | 295/500 [22:03<15:44,  4.61s/it] 59%|█████▉    | 296/500 [22:07<15:31,  4.57s/it] 59%|█████▉    | 297/500 [22:12<15:29,  4.58s/it] 60%|█████▉    | 298/500 [22:17<15:25,  4.58s/it] 60%|█████▉    | 299/500 [22:21<15:07,  4.51s/it] 60%|██████    | 300/500 [22:26<15:11,  4.56s/it] 60%|██████    | 301/500 [22:30<15:09,  4.57s/it] 60%|██████    | 302/500 [22:35<14:58,  4.54s/it] 61%|██████    | 303/500 [22:39<14:33,  4.43s/it] 61%|██████    | 304/500 [22:43<14:23,  4.40s/it] 61%|██████    | 305/500 [22:48<14:24,  4.43s/it] 61%|██████    | 306/500 [22:52<14:28,  4.48s/it] 61%|██████▏   | 307/500 [22:57<14:13,  4.42s/it] 62%|██████▏   | 308/500 [23:01<14:26,  4.51s/it] 62%|██████▏   | 309/500 [23:06<14:19,  4.50s/it] 62%|██████▏   | 310/500 [23:10<14:08,  4.46s/it] 62%|██████▏   | 311/500 [23:15<14:13,  4.51s/it] 62%|██████▏   | 312/500 [23:19<14:06,  4.50s/it] 63%|██████▎   | 313/500 [23:24<14:02,  4.51s/it] 63%|██████▎   | 314/500 [23:28<14:07,  4.56s/it] 63%|██████▎   | 315/500 [23:33<13:57,  4.52s/it] 63%|██████▎   | 316/500 [23:38<13:59,  4.56s/it] 63%|██████▎   | 317/500 [23:42<13:42,  4.50s/it] 64%|██████▎   | 318/500 [23:47<13:42,  4.52s/it] 64%|██████▍   | 319/500 [23:51<13:44,  4.56s/it] 64%|██████▍   | 320/500 [23:55<13:26,  4.48s/it] 64%|██████▍   | 321/500 [24:00<13:33,  4.54s/it] 64%|██████▍   | 322/500 [24:04<13:09,  4.44s/it] 65%|██████▍   | 323/500 [24:09<12:57,  4.39s/it] 65%|██████▍   | 324/500 [24:13<12:58,  4.43s/it] 65%|██████▌   | 325/500 [24:18<12:53,  4.42s/it] 65%|██████▌   | 326/500 [24:22<12:52,  4.44s/it] 65%|██████▌   | 327/500 [24:26<12:34,  4.36s/it] 66%|██████▌   | 328/500 [24:31<12:29,  4.36s/it] 66%|██████▌   | 329/500 [24:35<12:18,  4.32s/it] 66%|██████▌   | 330/500 [24:39<12:10,  4.30s/it] 66%|██████▌   | 331/500 [24:43<12:08,  4.31s/it] 66%|██████▋   | 332/500 [24:48<12:00,  4.29s/it] 67%|██████▋   | 333/500 [24:52<12:05,  4.34s/it] 67%|██████▋   | 334/500 [24:57<12:15,  4.43s/it] 67%|██████▋   | 335/500 [25:01<12:07,  4.41s/it] 67%|██████▋   | 336/500 [25:05<12:00,  4.39s/it] 67%|██████▋   | 337/500 [25:10<12:00,  4.42s/it] 68%|██████▊   | 338/500 [25:15<12:09,  4.50s/it] 68%|██████▊   | 339/500 [25:19<11:57,  4.45s/it] 68%|██████▊   | 340/500 [25:23<11:47,  4.42s/it] 68%|██████▊   | 341/500 [25:28<11:54,  4.50s/it] 68%|██████▊   | 342/500 [25:32<11:37,  4.42s/it] 69%|██████▊   | 343/500 [25:37<11:43,  4.48s/it] 69%|██████▉   | 344/500 [25:42<12:01,  4.63s/it] 69%|██████▉   | 345/500 [25:46<11:32,  4.47s/it] 69%|██████▉   | 346/500 [25:51<11:51,  4.62s/it] 69%|██████▉   | 347/500 [25:55<11:39,  4.57s/it] 70%|██████▉   | 348/500 [25:59<11:18,  4.46s/it] 70%|██████▉   | 349/500 [26:04<11:16,  4.48s/it] 70%|███████   | 350/500 [26:08<11:04,  4.43s/it] 70%|███████   | 351/500 [26:13<10:48,  4.35s/it] 70%|███████   | 352/500 [26:17<11:07,  4.51s/it] 71%|███████   | 353/500 [26:22<10:59,  4.49s/it] 71%|███████   | 354/500 [26:26<10:47,  4.43s/it] 71%|███████   | 355/500 [26:31<10:56,  4.52s/it] 71%|███████   | 356/500 [26:35<10:39,  4.44s/it] 71%|███████▏  | 357/500 [26:40<10:36,  4.45s/it] 72%|███████▏  | 358/500 [26:44<10:44,  4.54s/it] 72%|███████▏  | 359/500 [26:49<10:36,  4.51s/it] 72%|███████▏  | 360/500 [26:53<10:39,  4.56s/it] 72%|███████▏  | 361/500 [26:57<10:12,  4.41s/it] 72%|███████▏  | 362/500 [27:02<09:59,  4.34s/it] 73%|███████▎  | 363/500 [27:06<09:51,  4.31s/it] 73%|███████▎  | 364/500 [27:10<09:43,  4.29s/it] 73%|███████▎  | 365/500 [27:15<09:43,  4.32s/it] 73%|███████▎  | 366/500 [27:19<09:51,  4.41s/it] 73%|███████▎  | 367/500 [27:24<09:48,  4.43s/it] 74%|███████▎  | 368/500 [27:28<09:30,  4.33s/it] 74%|███████▍  | 369/500 [27:32<09:32,  4.37s/it] 74%|███████▍  | 370/500 [27:37<09:33,  4.41s/it] 74%|███████▍  | 371/500 [27:41<09:21,  4.35s/it] 74%|███████▍  | 372/500 [27:45<09:17,  4.35s/it] 75%|███████▍  | 373/500 [27:50<09:12,  4.35s/it] 75%|███████▍  | 374/500 [27:54<09:22,  4.47s/it] 75%|███████▌  | 375/500 [27:59<09:09,  4.40s/it] 75%|███████▌  | 376/500 [28:03<09:04,  4.39s/it] 75%|███████▌  | 377/500 [28:07<08:58,  4.38s/it] 76%|███████▌  | 378/500 [28:12<09:01,  4.44s/it] 76%|███████▌  | 379/500 [28:16<08:58,  4.45s/it] 76%|███████▌  | 380/500 [28:21<08:54,  4.46s/it] 76%|███████▌  | 381/500 [28:25<08:47,  4.43s/it] 76%|███████▋  | 382/500 [28:30<08:55,  4.53s/it] 77%|███████▋  | 383/500 [28:34<08:47,  4.51s/it] 77%|███████▋  | 384/500 [28:39<08:36,  4.45s/it] 77%|███████▋  | 385/500 [28:43<08:28,  4.42s/it] 77%|███████▋  | 386/500 [28:48<08:42,  4.58s/it] 77%|███████▋  | 387/500 [28:52<08:23,  4.46s/it] 78%|███████▊  | 388/500 [28:57<08:15,  4.43s/it] 78%|███████▊  | 389/500 [29:01<08:12,  4.44s/it] 78%|███████▊  | 390/500 [29:05<08:06,  4.42s/it] 78%|███████▊  | 391/500 [29:10<07:56,  4.37s/it] 78%|███████▊  | 392/500 [29:14<07:56,  4.41s/it] 79%|███████▊  | 393/500 [29:19<08:08,  4.56s/it] 79%|███████▉  | 394/500 [29:24<07:57,  4.51s/it] 79%|███████▉  | 395/500 [29:28<07:40,  4.39s/it] 79%|███████▉  | 396/500 [29:32<07:43,  4.46s/it] 79%|███████▉  | 397/500 [29:37<07:39,  4.46s/it] 80%|███████▉  | 398/500 [29:41<07:41,  4.52s/it] 80%|███████▉  | 399/500 [29:46<07:52,  4.67s/it] 80%|████████  | 400/500 [29:51<07:34,  4.55s/it] 80%|████████  | 401/500 [29:55<07:32,  4.57s/it] 80%|████████  | 402/500 [30:00<07:30,  4.60s/it] 81%|████████  | 403/500 [30:04<07:19,  4.54s/it] 81%|████████  | 404/500 [30:09<07:13,  4.52s/it] 81%|████████  | 405/500 [30:13<07:12,  4.55s/it] 81%|████████  | 406/500 [30:18<07:14,  4.63s/it] 81%|████████▏ | 407/500 [30:23<07:02,  4.55s/it] 81%|████████▏ | 407/500 [30:27<06:57,  4.49s/it]
Saving at 250...
Traceback (most recent call last):
  File "/gpfs/home1/scur2158/The-Power-of-Noise/src/generate_answers_llm.py", line 208, in <module>
    main()
    ~~~~^^
  File "/gpfs/home1/scur2158/The-Power-of-Noise/src/generate_answers_llm.py", line 202, in main
    generate_and_save(args, llm, prompt_dataloader)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home1/scur2158/The-Power-of-Noise/src/generate_answers_llm.py", line 158, in generate_and_save
    generated_output = llm.generate(prompts, max_new_tokens=args.max_new_tokens)
  File "/gpfs/home1/scur2158/The-Power-of-Noise/src/llm.py", line 119, in generate
    generated_ids = self.model.generate(
        **inputs,
    ...<5 lines>...
        eos_token_id=self.tokenizer.eos_token_id,
    )
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/generation/utils.py", line 2564, in generate
    result = decoding_method(
        self,
    ...<5 lines>...
        **model_kwargs,
    )
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/generation/utils.py", line 2784, in _sample
    outputs = self(**model_inputs, return_dict=True)
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/utils/generic.py", line 918, in wrapper
    output = func(self, *args, **kwargs)
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/models/llama/modeling_llama.py", line 459, in forward
    outputs: BaseModelOutputWithPast = self.model(
                                       ~~~~~~~~~~^
        input_ids=input_ids,
        ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/utils/generic.py", line 1064, in wrapper
    outputs = func(self, *args, **kwargs)
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/models/llama/modeling_llama.py", line 395, in forward
    hidden_states = decoder_layer(
        hidden_states,
    ...<5 lines>...
        **kwargs,
    )
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/modeling_layers.py", line 94, in __call__
    return super().__call__(*args, **kwargs)
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/utils/deprecation.py", line 172, in wrapped_func
    return func(*args, **kwargs)
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/models/llama/modeling_llama.py", line 309, in forward
    hidden_states = self.mlp(hidden_states)
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/models/llama/modeling_llama.py", line 155, in forward
    down_proj = self.down_proj(self.act_fn(self.gate_proj(x)) * self.up_proj(x))
                               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 964.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 761.25 MiB is free. Including non-PyTorch memory, this process has 38.74 GiB memory in use. Of the allocated memory 29.40 GiB is allocated by PyTorch, and 8.84 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Completed: far scenario with relevant documents

==========================================
Running experiment: mid scenario with relevant documents
Gold position: 4
Use random: False
==========================================
`torch_dtype` is deprecated! Use `dtype` instead!
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:08<00:08,  8.41s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  5.11s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  5.61s/it]
LLM loaded
Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 4
NUM DOCUMENTS IN CONTEXT: 9
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 20
SAVE EVERY: 250
  0%|          | 0/500 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
  0%|          | 1/500 [00:05<42:25,  5.10s/it]  0%|          | 2/500 [00:09<38:35,  4.65s/it]  1%|          | 3/500 [00:13<36:40,  4.43s/it]  1%|          | 4/500 [00:18<37:19,  4.52s/it]  1%|          | 5/500 [00:22<36:24,  4.41s/it]  1%|          | 6/500 [00:26<35:09,  4.27s/it]  1%|▏         | 7/500 [00:31<35:56,  4.37s/it]  2%|▏         | 8/500 [00:35<35:51,  4.37s/it]  2%|▏         | 9/500 [00:39<36:06,  4.41s/it]  2%|▏         | 10/500 [00:44<35:23,  4.33s/it]  2%|▏         | 11/500 [00:48<36:16,  4.45s/it]  2%|▏         | 12/500 [00:53<36:14,  4.46s/it]  3%|▎         | 13/500 [00:57<36:34,  4.51s/it]  3%|▎         | 14/500 [01:02<36:21,  4.49s/it]  3%|▎         | 15/500 [01:06<36:00,  4.46s/it]  3%|▎         | 16/500 [01:11<35:57,  4.46s/it]  3%|▎         | 17/500 [01:15<36:10,  4.49s/it]  4%|▎         | 18/500 [01:20<36:08,  4.50s/it]  4%|▍         | 19/500 [01:24<35:58,  4.49s/it]  4%|▍         | 20/500 [01:28<35:19,  4.41s/it]  4%|▍         | 21/500 [01:33<35:29,  4.45s/it]  4%|▍         | 22/500 [01:37<35:30,  4.46s/it]  5%|▍         | 23/500 [01:42<35:58,  4.53s/it]  5%|▍         | 24/500 [01:47<35:43,  4.50s/it]  5%|▌         | 25/500 [01:51<35:12,  4.45s/it]  5%|▌         | 26/500 [01:55<35:08,  4.45s/it]  5%|▌         | 27/500 [02:00<35:06,  4.45s/it]  6%|▌         | 28/500 [02:04<34:47,  4.42s/it]  6%|▌         | 29/500 [02:09<34:47,  4.43s/it]  6%|▌         | 30/500 [02:13<35:16,  4.50s/it]  6%|▌         | 31/500 [02:17<34:11,  4.37s/it]  6%|▋         | 32/500 [02:22<34:16,  4.40s/it]  7%|▋         | 33/500 [02:26<34:04,  4.38s/it]  7%|▋         | 34/500 [02:31<34:20,  4.42s/it]  7%|▋         | 35/500 [02:35<34:44,  4.48s/it]  7%|▋         | 36/500 [02:40<35:00,  4.53s/it]  7%|▋         | 37/500 [02:45<35:11,  4.56s/it]  8%|▊         | 38/500 [02:49<34:23,  4.47s/it]  8%|▊         | 39/500 [02:54<34:55,  4.54s/it]  8%|▊         | 40/500 [02:58<35:15,  4.60s/it]  8%|▊         | 41/500 [03:03<35:16,  4.61s/it]  8%|▊         | 42/500 [03:07<33:58,  4.45s/it]  9%|▊         | 43/500 [03:12<34:01,  4.47s/it]  9%|▉         | 44/500 [03:16<33:15,  4.38s/it]  9%|▉         | 45/500 [03:20<33:09,  4.37s/it]  9%|▉         | 46/500 [03:25<34:01,  4.50s/it]  9%|▉         | 47/500 [03:30<34:55,  4.63s/it] 10%|▉         | 48/500 [03:34<34:09,  4.53s/it] 10%|▉         | 49/500 [03:39<34:20,  4.57s/it] 10%|█         | 50/500 [03:43<34:05,  4.55s/it] 10%|█         | 51/500 [03:48<33:39,  4.50s/it] 10%|█         | 52/500 [03:52<33:51,  4.54s/it] 11%|█         | 53/500 [03:57<33:44,  4.53s/it] 11%|█         | 54/500 [04:01<33:41,  4.53s/it] 11%|█         | 55/500 [04:06<32:58,  4.45s/it] 11%|█         | 56/500 [04:10<33:39,  4.55s/it] 11%|█▏        | 57/500 [04:15<33:13,  4.50s/it] 12%|█▏        | 58/500 [04:19<33:03,  4.49s/it] 12%|█▏        | 59/500 [04:24<33:19,  4.53s/it] 12%|█▏        | 60/500 [04:28<33:12,  4.53s/it] 12%|█▏        | 61/500 [04:32<32:18,  4.42s/it] 12%|█▏        | 62/500 [04:37<32:53,  4.51s/it] 13%|█▎        | 63/500 [04:42<32:27,  4.46s/it] 13%|█▎        | 64/500 [04:46<32:13,  4.43s/it] 13%|█▎        | 65/500 [04:50<32:07,  4.43s/it] 13%|█▎        | 66/500 [04:55<32:36,  4.51s/it] 13%|█▎        | 67/500 [05:00<33:37,  4.66s/it] 14%|█▎        | 68/500 [05:05<33:48,  4.70s/it] 14%|█▍        | 69/500 [05:09<33:17,  4.63s/it] 14%|█▍        | 70/500 [05:14<32:40,  4.56s/it] 14%|█▍        | 71/500 [05:18<32:13,  4.51s/it] 14%|█▍        | 72/500 [05:22<31:47,  4.46s/it] 15%|█▍        | 73/500 [05:27<31:48,  4.47s/it] 15%|█▍        | 74/500 [05:31<31:31,  4.44s/it] 15%|█▌        | 75/500 [05:36<31:11,  4.40s/it] 15%|█▌        | 76/500 [05:40<30:38,  4.34s/it] 15%|█▌        | 77/500 [05:44<31:05,  4.41s/it] 16%|█▌        | 78/500 [05:49<32:16,  4.59s/it] 16%|█▌        | 79/500 [05:54<31:25,  4.48s/it] 16%|█▌        | 80/500 [05:58<31:28,  4.50s/it] 16%|█▌        | 81/500 [06:03<31:23,  4.49s/it] 16%|█▋        | 82/500 [06:07<31:10,  4.48s/it] 17%|█▋        | 83/500 [06:12<31:18,  4.51s/it] 17%|█▋        | 84/500 [06:16<30:53,  4.46s/it] 17%|█▋        | 85/500 [06:20<30:02,  4.34s/it] 17%|█▋        | 86/500 [06:24<30:10,  4.37s/it] 17%|█▋        | 87/500 [06:29<31:09,  4.53s/it] 18%|█▊        | 88/500 [06:34<30:49,  4.49s/it] 18%|█▊        | 89/500 [06:38<30:06,  4.40s/it] 18%|█▊        | 90/500 [06:43<30:24,  4.45s/it] 18%|█▊        | 91/500 [06:47<30:25,  4.46s/it] 18%|█▊        | 92/500 [06:51<30:00,  4.41s/it] 19%|█▊        | 93/500 [06:56<29:58,  4.42s/it] 19%|█▉        | 94/500 [07:00<29:45,  4.40s/it] 19%|█▉        | 95/500 [07:04<29:14,  4.33s/it] 19%|█▉        | 96/500 [07:09<29:09,  4.33s/it] 19%|█▉        | 97/500 [07:13<29:35,  4.41s/it] 20%|█▉        | 98/500 [07:18<29:52,  4.46s/it] 20%|█▉        | 99/500 [07:23<30:29,  4.56s/it] 20%|██        | 100/500 [07:27<30:41,  4.60s/it] 20%|██        | 101/500 [07:32<30:07,  4.53s/it] 20%|██        | 102/500 [07:36<29:26,  4.44s/it] 21%|██        | 103/500 [07:40<29:40,  4.48s/it] 21%|██        | 104/500 [07:45<29:04,  4.40s/it] 21%|██        | 105/500 [07:49<28:55,  4.39s/it] 21%|██        | 106/500 [07:54<29:22,  4.47s/it] 21%|██▏       | 107/500 [07:58<29:49,  4.55s/it] 22%|██▏       | 108/500 [08:03<29:21,  4.49s/it] 22%|██▏       | 109/500 [08:07<29:00,  4.45s/it] 22%|██▏       | 110/500 [08:12<28:44,  4.42s/it] 22%|██▏       | 111/500 [08:16<29:00,  4.47s/it] 22%|██▏       | 112/500 [08:21<28:54,  4.47s/it] 23%|██▎       | 113/500 [08:25<29:13,  4.53s/it] 23%|██▎       | 114/500 [08:30<29:05,  4.52s/it] 23%|██▎       | 115/500 [08:34<29:07,  4.54s/it] 23%|██▎       | 116/500 [08:39<29:47,  4.65s/it] 23%|██▎       | 117/500 [08:44<29:45,  4.66s/it] 24%|██▎       | 118/500 [08:49<29:36,  4.65s/it] 24%|██▍       | 119/500 [08:53<29:27,  4.64s/it] 24%|██▍       | 120/500 [08:57<28:37,  4.52s/it] 24%|██▍       | 121/500 [09:02<28:24,  4.50s/it] 24%|██▍       | 122/500 [09:06<28:05,  4.46s/it] 25%|██▍       | 123/500 [09:11<27:57,  4.45s/it] 25%|██▍       | 124/500 [09:15<27:44,  4.43s/it] 25%|██▌       | 125/500 [09:19<27:35,  4.42s/it] 25%|██▌       | 126/500 [09:24<27:49,  4.46s/it] 25%|██▌       | 127/500 [09:28<27:44,  4.46s/it] 26%|██▌       | 128/500 [09:34<28:52,  4.66s/it] 26%|██▌       | 129/500 [09:38<28:45,  4.65s/it] 26%|██▌       | 130/500 [09:43<28:09,  4.56s/it] 26%|██▌       | 131/500 [09:48<28:54,  4.70s/it] 26%|██▋       | 132/500 [09:52<28:08,  4.59s/it] 27%|██▋       | 133/500 [09:56<28:04,  4.59s/it] 27%|██▋       | 134/500 [10:01<28:30,  4.67s/it] 27%|██▋       | 135/500 [10:06<27:51,  4.58s/it] 27%|██▋       | 136/500 [10:10<27:23,  4.51s/it] 27%|██▋       | 137/500 [10:15<27:35,  4.56s/it] 28%|██▊       | 138/500 [10:19<26:55,  4.46s/it] 28%|██▊       | 139/500 [10:23<26:07,  4.34s/it] 28%|██▊       | 140/500 [10:28<26:34,  4.43s/it] 28%|██▊       | 141/500 [10:32<26:23,  4.41s/it] 28%|██▊       | 142/500 [10:37<26:59,  4.52s/it] 29%|██▊       | 143/500 [10:41<26:30,  4.45s/it] 29%|██▉       | 144/500 [10:46<27:15,  4.59s/it] 29%|██▉       | 145/500 [10:51<27:59,  4.73s/it] 29%|██▉       | 146/500 [10:56<27:27,  4.65s/it] 29%|██▉       | 147/500 [11:00<27:03,  4.60s/it] 30%|██▉       | 148/500 [11:04<26:36,  4.53s/it] 30%|██▉       | 149/500 [11:09<26:08,  4.47s/it] 30%|███       | 150/500 [11:14<26:51,  4.61s/it] 30%|███       | 151/500 [11:18<26:52,  4.62s/it] 30%|███       | 152/500 [11:22<26:00,  4.49s/it] 31%|███       | 153/500 [11:27<26:26,  4.57s/it] 31%|███       | 154/500 [11:32<25:48,  4.47s/it] 31%|███       | 155/500 [11:36<25:42,  4.47s/it] 31%|███       | 156/500 [11:40<25:08,  4.38s/it] 31%|███▏      | 157/500 [11:45<25:41,  4.49s/it] 32%|███▏      | 158/500 [11:50<26:16,  4.61s/it] 32%|███▏      | 159/500 [11:54<25:58,  4.57s/it] 32%|███▏      | 160/500 [11:58<25:12,  4.45s/it] 32%|███▏      | 161/500 [12:03<25:07,  4.45s/it] 32%|███▏      | 162/500 [12:07<25:16,  4.49s/it] 33%|███▎      | 163/500 [12:12<25:22,  4.52s/it] 33%|███▎      | 164/500 [12:17<25:28,  4.55s/it] 33%|███▎      | 165/500 [12:21<25:22,  4.55s/it] 33%|███▎      | 166/500 [12:26<25:07,  4.51s/it] 33%|███▎      | 167/500 [12:30<24:30,  4.42s/it] 34%|███▎      | 168/500 [12:34<24:27,  4.42s/it] 34%|███▍      | 169/500 [12:39<25:01,  4.54s/it] 34%|███▍      | 170/500 [12:43<24:10,  4.39s/it] 34%|███▍      | 171/500 [12:48<24:05,  4.39s/it] 34%|███▍      | 172/500 [12:52<24:32,  4.49s/it] 35%|███▍      | 173/500 [12:56<23:57,  4.40s/it] 35%|███▍      | 174/500 [13:01<23:59,  4.41s/it] 35%|███▌      | 175/500 [13:05<23:49,  4.40s/it] 35%|███▌      | 176/500 [13:09<23:23,  4.33s/it] 35%|███▌      | 177/500 [13:14<24:16,  4.51s/it] 36%|███▌      | 178/500 [13:19<24:47,  4.62s/it] 36%|███▌      | 179/500 [13:24<24:17,  4.54s/it] 36%|███▌      | 180/500 [13:28<24:36,  4.61s/it] 36%|███▌      | 181/500 [13:33<24:41,  4.64s/it] 36%|███▋      | 182/500 [13:37<24:10,  4.56s/it] 37%|███▋      | 183/500 [13:42<23:20,  4.42s/it] 37%|███▋      | 184/500 [13:46<23:17,  4.42s/it] 37%|███▋      | 185/500 [13:51<23:40,  4.51s/it] 37%|███▋      | 186/500 [13:55<23:24,  4.47s/it] 37%|███▋      | 187/500 [13:59<22:52,  4.38s/it] 38%|███▊      | 188/500 [14:04<22:45,  4.38s/it] 38%|███▊      | 189/500 [14:08<22:41,  4.38s/it] 38%|███▊      | 190/500 [14:12<22:23,  4.33s/it] 38%|███▊      | 191/500 [14:17<22:35,  4.39s/it] 38%|███▊      | 192/500 [14:21<22:40,  4.42s/it] 39%|███▊      | 193/500 [14:26<22:31,  4.40s/it] 39%|███▉      | 194/500 [14:30<22:57,  4.50s/it] 39%|███▉      | 195/500 [14:35<23:14,  4.57s/it] 39%|███▉      | 196/500 [14:39<22:44,  4.49s/it] 39%|███▉      | 197/500 [14:44<22:22,  4.43s/it] 40%|███▉      | 198/500 [14:48<22:10,  4.41s/it] 40%|███▉      | 199/500 [14:52<22:00,  4.39s/it] 40%|████      | 200/500 [14:57<22:47,  4.56s/it] 40%|████      | 201/500 [15:02<22:19,  4.48s/it] 40%|████      | 202/500 [15:06<22:17,  4.49s/it] 41%|████      | 203/500 [15:10<21:46,  4.40s/it] 41%|████      | 204/500 [15:15<21:47,  4.42s/it] 41%|████      | 205/500 [15:19<21:52,  4.45s/it] 41%|████      | 206/500 [15:24<21:52,  4.46s/it] 41%|████▏     | 207/500 [15:28<21:48,  4.47s/it] 42%|████▏     | 208/500 [15:33<22:04,  4.54s/it] 42%|████▏     | 209/500 [15:38<22:15,  4.59s/it] 42%|████▏     | 210/500 [15:42<21:59,  4.55s/it] 42%|████▏     | 211/500 [15:46<21:14,  4.41s/it] 42%|████▏     | 212/500 [15:51<21:05,  4.39s/it] 43%|████▎     | 213/500 [15:55<21:00,  4.39s/it] 43%|████▎     | 214/500 [16:00<21:22,  4.49s/it] 43%|████▎     | 215/500 [16:04<20:51,  4.39s/it] 43%|████▎     | 216/500 [16:08<21:09,  4.47s/it] 43%|████▎     | 217/500 [16:13<20:43,  4.39s/it] 44%|████▎     | 218/500 [16:17<20:37,  4.39s/it] 44%|████▍     | 219/500 [16:22<21:01,  4.49s/it] 44%|████▍     | 220/500 [16:26<20:55,  4.48s/it] 44%|████▍     | 221/500 [16:31<20:41,  4.45s/it] 44%|████▍     | 222/500 [16:35<20:23,  4.40s/it] 45%|████▍     | 223/500 [16:39<20:28,  4.44s/it] 45%|████▍     | 224/500 [16:44<20:14,  4.40s/it] 45%|████▌     | 225/500 [16:48<20:09,  4.40s/it] 45%|████▌     | 226/500 [16:52<20:01,  4.39s/it] 45%|████▌     | 227/500 [16:57<20:06,  4.42s/it] 46%|████▌     | 228/500 [17:01<19:52,  4.39s/it] 46%|████▌     | 229/500 [17:06<19:36,  4.34s/it] 46%|████▌     | 230/500 [17:10<19:33,  4.35s/it] 46%|████▌     | 231/500 [17:14<19:25,  4.33s/it] 46%|████▋     | 232/500 [17:18<19:08,  4.29s/it] 47%|████▋     | 233/500 [17:23<19:00,  4.27s/it] 47%|████▋     | 234/500 [17:27<19:16,  4.35s/it] 47%|████▋     | 235/500 [17:32<19:21,  4.38s/it] 47%|████▋     | 236/500 [17:36<19:10,  4.36s/it] 47%|████▋     | 237/500 [17:41<19:35,  4.47s/it] 48%|████▊     | 238/500 [17:45<19:08,  4.38s/it] 48%|████▊     | 239/500 [17:49<19:22,  4.46s/it] 48%|████▊     | 240/500 [17:54<19:33,  4.51s/it] 48%|████▊     | 241/500 [17:58<19:23,  4.49s/it] 48%|████▊     | 242/500 [18:03<19:02,  4.43s/it] 49%|████▊     | 243/500 [18:07<19:20,  4.51s/it] 49%|████▉     | 244/500 [18:12<19:43,  4.62s/it] 49%|████▉     | 245/500 [18:17<19:30,  4.59s/it] 49%|████▉     | 246/500 [18:21<18:59,  4.48s/it] 49%|████▉     | 247/500 [18:26<18:52,  4.48s/it] 50%|████▉     | 248/500 [18:30<19:02,  4.53s/it] 50%|████▉     | 249/500 [18:35<18:53,  4.52s/it] 50%|█████     | 250/500 [18:39<19:06,  4.59s/it] 50%|█████     | 251/500 [18:44<18:47,  4.53s/it] 50%|█████     | 252/500 [18:48<18:27,  4.46s/it] 51%|█████     | 253/500 [18:53<18:30,  4.50s/it] 51%|█████     | 254/500 [18:57<18:07,  4.42s/it] 51%|█████     | 255/500 [19:02<18:24,  4.51s/it] 51%|█████     | 256/500 [19:07<18:54,  4.65s/it] 51%|█████▏    | 257/500 [19:11<18:51,  4.66s/it] 52%|█████▏    | 258/500 [19:16<18:32,  4.60s/it] 52%|█████▏    | 259/500 [19:20<18:29,  4.60s/it] 52%|█████▏    | 260/500 [19:25<18:18,  4.58s/it] 52%|█████▏    | 261/500 [19:30<18:17,  4.59s/it] 52%|█████▏    | 262/500 [19:34<17:43,  4.47s/it] 53%|█████▎    | 263/500 [19:38<17:30,  4.43s/it] 53%|█████▎    | 264/500 [19:43<17:39,  4.49s/it] 53%|█████▎    | 265/500 [19:47<17:27,  4.46s/it] 53%|█████▎    | 266/500 [19:52<17:41,  4.54s/it] 53%|█████▎    | 267/500 [19:56<17:42,  4.56s/it] 54%|█████▎    | 268/500 [20:01<17:12,  4.45s/it] 54%|█████▍    | 269/500 [20:05<17:28,  4.54s/it] 54%|█████▍    | 270/500 [20:10<17:03,  4.45s/it] 54%|█████▍    | 271/500 [20:14<17:00,  4.46s/it] 54%|█████▍    | 272/500 [20:19<17:13,  4.53s/it] 55%|█████▍    | 273/500 [20:23<16:47,  4.44s/it] 55%|█████▍    | 274/500 [20:27<16:42,  4.44s/it] 55%|█████▌    | 275/500 [20:32<16:33,  4.42s/it] 55%|█████▌    | 276/500 [20:36<16:26,  4.41s/it] 55%|█████▌    | 277/500 [20:41<16:38,  4.48s/it] 56%|█████▌    | 278/500 [20:45<15:59,  4.32s/it] 56%|█████▌    | 279/500 [20:49<16:04,  4.37s/it] 56%|█████▌    | 280/500 [20:54<15:56,  4.35s/it] 56%|█████▌    | 281/500 [20:59<16:29,  4.52s/it] 56%|█████▋    | 282/500 [21:03<16:06,  4.43s/it] 57%|█████▋    | 283/500 [21:07<16:08,  4.46s/it] 57%|█████▋    | 284/500 [21:12<15:56,  4.43s/it] 57%|█████▋    | 285/500 [21:16<16:07,  4.50s/it] 57%|█████▋    | 286/500 [21:21<15:59,  4.48s/it] 57%|█████▋    | 287/500 [21:25<16:12,  4.57s/it] 58%|█████▊    | 288/500 [21:30<16:12,  4.59s/it] 58%|█████▊    | 289/500 [21:34<15:41,  4.46s/it] 58%|█████▊    | 290/500 [21:39<16:06,  4.60s/it] 58%|█████▊    | 291/500 [21:43<15:28,  4.44s/it] 58%|█████▊    | 292/500 [21:48<15:28,  4.46s/it] 59%|█████▊    | 293/500 [21:52<15:14,  4.42s/it] 59%|█████▉    | 294/500 [21:56<15:06,  4.40s/it] 59%|█████▉    | 295/500 [22:02<15:42,  4.60s/it] 59%|█████▉    | 296/500 [22:06<15:30,  4.56s/it] 59%|█████▉    | 297/500 [22:11<15:28,  4.57s/it] 60%|█████▉    | 298/500 [22:15<15:24,  4.58s/it] 60%|█████▉    | 299/500 [22:20<15:05,  4.51s/it] 60%|██████    | 300/500 [22:24<15:10,  4.55s/it] 60%|██████    | 301/500 [22:29<15:08,  4.56s/it] 60%|██████    | 302/500 [22:33<14:57,  4.53s/it] 61%|██████    | 303/500 [22:37<14:32,  4.43s/it] 61%|██████    | 304/500 [22:42<14:22,  4.40s/it] 61%|██████    | 305/500 [22:46<14:24,  4.43s/it] 61%|██████    | 306/500 [22:51<14:28,  4.48s/it] 61%|██████▏   | 307/500 [22:55<14:13,  4.42s/it] 62%|██████▏   | 308/500 [23:00<14:25,  4.51s/it] 62%|██████▏   | 309/500 [23:04<14:18,  4.49s/it] 62%|██████▏   | 310/500 [23:09<14:06,  4.46s/it] 62%|██████▏   | 311/500 [23:13<14:12,  4.51s/it] 62%|██████▏   | 312/500 [23:18<14:04,  4.49s/it] 63%|██████▎   | 313/500 [23:22<14:01,  4.50s/it] 63%|██████▎   | 314/500 [23:27<14:06,  4.55s/it] 63%|██████▎   | 315/500 [23:31<13:56,  4.52s/it] 63%|██████▎   | 316/500 [23:36<13:58,  4.56s/it] 63%|██████▎   | 317/500 [23:40<13:42,  4.49s/it] 64%|██████▎   | 318/500 [23:45<13:41,  4.51s/it] 64%|██████▍   | 319/500 [23:50<13:43,  4.55s/it] 64%|██████▍   | 320/500 [23:54<13:25,  4.48s/it] 64%|██████▍   | 321/500 [23:59<13:32,  4.54s/it] 64%|██████▍   | 322/500 [24:03<13:08,  4.43s/it] 65%|██████▍   | 323/500 [24:07<12:56,  4.39s/it] 65%|██████▍   | 324/500 [24:12<12:58,  4.42s/it] 65%|██████▌   | 325/500 [24:16<12:52,  4.41s/it] 65%|██████▌   | 326/500 [24:20<12:52,  4.44s/it] 65%|██████▌   | 327/500 [24:25<12:33,  4.36s/it] 66%|██████▌   | 328/500 [24:29<12:28,  4.35s/it] 66%|██████▌   | 329/500 [24:33<12:17,  4.31s/it] 66%|██████▌   | 330/500 [24:37<12:09,  4.29s/it] 66%|██████▌   | 331/500 [24:42<12:07,  4.31s/it] 66%|██████▋   | 332/500 [24:46<11:59,  4.28s/it] 67%|██████▋   | 333/500 [24:50<12:04,  4.34s/it] 67%|██████▋   | 334/500 [24:55<12:14,  4.42s/it] 67%|██████▋   | 335/500 [24:59<12:06,  4.40s/it] 67%|██████▋   | 336/500 [25:04<11:59,  4.39s/it] 67%|██████▋   | 337/500 [25:08<11:59,  4.41s/it] 68%|██████▊   | 338/500 [25:13<12:09,  4.50s/it] 68%|██████▊   | 339/500 [25:17<11:56,  4.45s/it] 68%|██████▊   | 340/500 [25:22<11:47,  4.42s/it] 68%|██████▊   | 341/500 [25:26<11:53,  4.49s/it] 68%|██████▊   | 342/500 [25:31<11:36,  4.41s/it] 69%|██████▊   | 343/500 [25:35<11:42,  4.47s/it] 69%|██████▉   | 344/500 [25:40<11:59,  4.61s/it] 69%|██████▉   | 345/500 [25:44<11:31,  4.46s/it] 69%|██████▉   | 346/500 [25:49<11:49,  4.61s/it] 69%|██████▉   | 347/500 [25:54<11:37,  4.56s/it] 70%|██████▉   | 348/500 [25:58<11:17,  4.46s/it] 70%|██████▉   | 349/500 [26:02<11:16,  4.48s/it] 70%|███████   | 350/500 [26:07<11:03,  4.42s/it] 70%|███████   | 351/500 [26:11<10:47,  4.35s/it] 70%|███████   | 352/500 [26:16<11:06,  4.50s/it] 71%|███████   | 353/500 [26:20<11:00,  4.49s/it] 71%|███████   | 354/500 [26:24<10:47,  4.43s/it] 71%|███████   | 355/500 [26:29<10:55,  4.52s/it] 71%|███████   | 356/500 [26:33<10:38,  4.44s/it] 71%|███████▏  | 357/500 [26:38<10:35,  4.45s/it] 72%|███████▏  | 358/500 [26:43<10:43,  4.53s/it] 72%|███████▏  | 359/500 [26:47<10:35,  4.51s/it] 72%|███████▏  | 360/500 [26:52<10:38,  4.56s/it] 72%|███████▏  | 361/500 [26:56<10:11,  4.40s/it] 72%|███████▏  | 362/500 [27:00<09:58,  4.34s/it] 73%|███████▎  | 363/500 [27:04<09:49,  4.31s/it] 73%|███████▎  | 364/500 [27:08<09:42,  4.28s/it] 73%|███████▎  | 365/500 [27:13<09:41,  4.31s/it] 73%|███████▎  | 366/500 [27:17<09:50,  4.40s/it] 73%|███████▎  | 367/500 [27:22<09:47,  4.42s/it] 74%|███████▎  | 368/500 [27:26<09:30,  4.32s/it] 74%|███████▍  | 369/500 [27:30<09:31,  4.36s/it] 74%|███████▍  | 370/500 [27:35<09:32,  4.41s/it] 74%|███████▍  | 371/500 [27:39<09:20,  4.35s/it] 74%|███████▍  | 372/500 [27:43<09:16,  4.35s/it] 75%|███████▍  | 373/500 [27:48<09:11,  4.34s/it] 75%|███████▍  | 374/500 [27:53<09:21,  4.46s/it] 75%|███████▌  | 375/500 [27:57<09:08,  4.39s/it] 75%|███████▌  | 376/500 [28:01<09:03,  4.38s/it] 75%|███████▌  | 377/500 [28:05<08:57,  4.37s/it] 76%|███████▌  | 378/500 [28:10<09:00,  4.43s/it] 76%|███████▌  | 379/500 [28:15<08:57,  4.44s/it] 76%|███████▌  | 380/500 [28:19<08:53,  4.45s/it] 76%|███████▌  | 381/500 [28:23<08:46,  4.42s/it] 76%|███████▋  | 382/500 [28:28<08:54,  4.53s/it] 77%|███████▋  | 383/500 [28:33<08:47,  4.51s/it] 77%|███████▋  | 384/500 [28:37<08:35,  4.45s/it] 77%|███████▋  | 385/500 [28:41<08:28,  4.42s/it] 77%|███████▋  | 386/500 [28:46<08:41,  4.58s/it] 77%|███████▋  | 387/500 [28:50<08:24,  4.46s/it] 78%|███████▊  | 388/500 [28:55<08:15,  4.43s/it] 78%|███████▊  | 389/500 [28:59<08:12,  4.44s/it] 78%|███████▊  | 390/500 [29:04<08:06,  4.42s/it] 78%|███████▊  | 391/500 [29:08<07:56,  4.37s/it] 78%|███████▊  | 392/500 [29:12<07:56,  4.41s/it] 79%|███████▊  | 393/500 [29:17<08:08,  4.56s/it] 79%|███████▉  | 394/500 [29:22<07:57,  4.50s/it] 79%|███████▉  | 395/500 [29:26<07:40,  4.38s/it] 79%|███████▉  | 396/500 [29:30<07:42,  4.45s/it] 79%|███████▉  | 397/500 [29:35<07:37,  4.45s/it] 80%|███████▉  | 398/500 [29:39<07:40,  4.51s/it] 80%|███████▉  | 399/500 [29:44<07:51,  4.66s/it] 80%|████████  | 400/500 [29:49<07:33,  4.54s/it] 80%|████████  | 401/500 [29:53<07:31,  4.56s/it] 80%|████████  | 402/500 [29:58<07:30,  4.59s/it] 81%|████████  | 403/500 [30:02<07:19,  4.53s/it] 81%|████████  | 404/500 [30:07<07:13,  4.51s/it] 81%|████████  | 405/500 [30:11<07:11,  4.54s/it] 81%|████████  | 406/500 [30:16<07:14,  4.62s/it] 81%|████████▏ | 407/500 [30:21<07:02,  4.54s/it] 81%|████████▏ | 407/500 [30:25<06:57,  4.48s/it]
Saving at 250...
Traceback (most recent call last):
  File "/gpfs/home1/scur2158/The-Power-of-Noise/src/generate_answers_llm.py", line 208, in <module>
    main()
    ~~~~^^
  File "/gpfs/home1/scur2158/The-Power-of-Noise/src/generate_answers_llm.py", line 202, in main
    generate_and_save(args, llm, prompt_dataloader)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home1/scur2158/The-Power-of-Noise/src/generate_answers_llm.py", line 158, in generate_and_save
    generated_output = llm.generate(prompts, max_new_tokens=args.max_new_tokens)
  File "/gpfs/home1/scur2158/The-Power-of-Noise/src/llm.py", line 119, in generate
    generated_ids = self.model.generate(
        **inputs,
    ...<5 lines>...
        eos_token_id=self.tokenizer.eos_token_id,
    )
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/generation/utils.py", line 2564, in generate
    result = decoding_method(
        self,
    ...<5 lines>...
        **model_kwargs,
    )
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/generation/utils.py", line 2784, in _sample
    outputs = self(**model_inputs, return_dict=True)
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/utils/generic.py", line 918, in wrapper
    output = func(self, *args, **kwargs)
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/models/llama/modeling_llama.py", line 459, in forward
    outputs: BaseModelOutputWithPast = self.model(
                                       ~~~~~~~~~~^
        input_ids=input_ids,
        ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/utils/generic.py", line 1064, in wrapper
    outputs = func(self, *args, **kwargs)
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/models/llama/modeling_llama.py", line 395, in forward
    hidden_states = decoder_layer(
        hidden_states,
    ...<5 lines>...
        **kwargs,
    )
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/modeling_layers.py", line 94, in __call__
    return super().__call__(*args, **kwargs)
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/utils/deprecation.py", line 172, in wrapped_func
    return func(*args, **kwargs)
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/models/llama/modeling_llama.py", line 309, in forward
    hidden_states = self.mlp(hidden_states)
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/scur2158/.local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/scur2158/.local/lib/python3.13/site-packages/transformers/models/llama/modeling_llama.py", line 155, in forward
    down_proj = self.down_proj(self.act_fn(self.gate_proj(x)) * self.up_proj(x))
                               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 964.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 761.25 MiB is free. Including non-PyTorch memory, this process has 38.74 GiB memory in use. Of the allocated memory 29.40 GiB is allocated by PyTorch, and 8.84 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Completed: mid scenario with relevant documents

